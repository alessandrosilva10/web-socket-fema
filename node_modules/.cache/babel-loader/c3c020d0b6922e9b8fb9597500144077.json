{"ast":null,"code":"import _regeneratorRuntime from \"/home/alessandro/Desktop/backend_almir/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/alessandro/Desktop/backend_almir/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/alessandro/Desktop/backend_almir/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/alessandro/Desktop/backend_almir/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/home/alessandro/Desktop/backend_almir/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/home/alessandro/Desktop/backend_almir/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/alessandro/Desktop/backend_almir/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"/home/alessandro/Desktop/backend_almir/frontend/src/views/Index.js\";\n\n/*!\n\n=========================================================\n* Argon Dashboard React - v1.1.0\n=========================================================\n\n* Product Page: https://www.creative-tim.com/product/argon-dashboard-react\n* Copyright 2019 Creative Tim (https://www.creative-tim.com)\n* Licensed under MIT (https://github.com/creativetimofficial/argon-dashboard-react/blob/master/LICENSE.md)\n\n* Coded by Creative Tim\n\n=========================================================\n\n* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\n*/\nimport React from \"react\"; // javascipt plugin for creating charts\n\nimport Chart from \"chart.js\";\nimport { withCookies } from \"react-cookie\";\nimport { toast, ToastContainer } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.min.css';\nimport ListNotes from './ListNotes'; //import { fetchNotes, fetchNote, updateNote } from '../../src/api';\n\nimport AddNoteForm from \"./AddNoteForm\";\nimport EditNoteForm from \"./EditNoteForm\";\nimport Websocket from 'react-websocket'; // reactstrap components\n\nimport { Container, Row, Col, Button } from \"reactstrap\"; // core components\n\nimport { chartOptions, parseOptions } from \"variables/charts.js\";\nimport Header from \"components/Headers/Header.js\";\n\nvar Index = /*#__PURE__*/function (_React$Component) {\n  _inherits(Index, _React$Component);\n\n  var _super = _createSuper(Index);\n\n  function Index(props) {\n    var _this;\n\n    _classCallCheck(this, Index);\n\n    _this = _super.call(this, props);\n\n    _this.sucess = function () {\n      return toast.success(\"Usuário logado com sucesso!\");\n    };\n\n    _this.warning = function () {\n      return toast.warning(\"Usuário não autenticado!\");\n    };\n\n    _this.toggleNavs = function (e, index) {\n      e.preventDefault();\n\n      _this.setState({\n        activeNav: index,\n        chartExample1Data: _this.state.chartExample1Data === \"data1\" ? \"data2\" : \"data1\"\n      });\n    };\n\n    _this.url = 'http://127.0.0.1:8000/api/v1/notes/';\n    _this.fetchNotes = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              fetch(_this.url, {\n                method: 'POST',\n                headers: {\n                  Accept: 'application/json',\n                  'Content-Type': 'application/json',\n                  'Authorization': \"Token \".concat(_this.props.cookies.get('token'))\n                }\n              }).then(function (res) {\n                return res.json();\n              }).then(function (data) {\n                return data;\n              });\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    _this.fetchNote = function (id) {\n      fetch(_this.url + id, {\n        method: 'GET',\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json',\n          'Authorization': \"Token \".concat(_this.props.cookies.get('token'))\n        }\n      }).then(function (res) {\n        return res.json();\n      }).then(function (data) {\n        return data;\n      });\n    };\n\n    _this.addNote = function (note) {\n      fetch(_this.url, {\n        method: 'POST',\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json',\n          'Authorization': \"Token \".concat(_this.props.cookies.get('token'))\n        },\n        body: JSON.stringify(note)\n      }).then(function (res) {\n        return res.json();\n      }).then(function (data) {\n        console.log(data);\n      });\n      return note;\n    };\n\n    _this.state = {\n      activeNav: 1,\n      chartExample1Data: \"data1\",\n      notes: [],\n      note: {},\n      current_note_id: 0,\n      is_creating: true\n    };\n    _this.handleItemClick = _this.handleItemClick.bind(_assertThisInitialized(_this));\n    _this.handleAddItem = _this.handleAddItem.bind(_assertThisInitialized(_this));\n    _this.addNote = _this.addNote.bind(_assertThisInitialized(_this));\n    _this.getData = _this.getData.bind(_assertThisInitialized(_this));\n    _this.handleSaveNote = _this.handleSaveNote.bind(_assertThisInitialized(_this));\n    _this.fetchNotes = _this.fetchNotes.bind(_assertThisInitialized(_this));\n    _this.handleOnChange = _this.handleOnChange.bind(_assertThisInitialized(_this));\n\n    if (window.Chart) {\n      parseOptions(Chart, chartOptions());\n    }\n\n    return _this;\n  }\n\n  _createClass(Index, [{\n    key: \"getData\",\n    value: function () {\n      var _getData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var _this2 = this;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                fetch(this.url, {\n                  method: 'GET',\n                  headers: {\n                    'Authorization': \"Token \".concat(this.props.cookies.get('token'))\n                  }\n                }).then(function (resp) {\n                  return resp.json();\n                }).then(function (res) {\n                  return _this2.setState({\n                    notes: res\n                  }, function () {\n                    console.log(this.state.notes);\n                    console.log(this.props.cookies.get('token'));\n                  });\n                }).catch(function (error) {\n                  return console.log(error);\n                });\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function getData() {\n        return _getData.apply(this, arguments);\n      }\n\n      return getData;\n    }()\n  }, {\n    key: \"handleItemClick\",\n    value: function () {\n      var _handleItemClick = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id) {\n        var selected_note;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return fetchNote(id);\n\n              case 2:\n                selected_note = _context3.sent;\n                this.setState(function (prevState) {\n                  return {\n                    is_creating: false,\n                    current_note_id: id,\n                    note: selected_note\n                  };\n                });\n\n              case 4:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function handleItemClick(_x) {\n        return _handleItemClick.apply(this, arguments);\n      }\n\n      return handleItemClick;\n    }()\n  }, {\n    key: \"handleAddItem\",\n    value: function handleAddItem() {\n      this.setState(function (prevState) {\n        return {\n          is_creating: true\n        };\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this3 = this;\n\n      this.sucess();\n      fetch('http://127.0.0.1:8000/api/v1/notes/', {\n        method: 'GET',\n        headers: {\n          'Authorization': \"Token \".concat(this.props.cookies.get('token'))\n        }\n      }).then(function (resp) {\n        return resp.json();\n      }).then(function (res) {\n        return _this3.setState({\n          notes: res\n        }, function () {\n          console.log(this.state.notes);\n          console.log(this.props.cookies.get('token'));\n        });\n      }).catch(function (error) {\n        return console.log(error);\n      });\n    }\n  }, {\n    key: \"handleSaveNote\",\n    value: function () {\n      var _handleSaveNote = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(data) {\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return this.addNote(data);\n\n              case 2:\n                _context4.next = 4;\n                return this.getData();\n\n              case 4:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function handleSaveNote(_x2) {\n        return _handleSaveNote.apply(this, arguments);\n      }\n\n      return handleSaveNote;\n    }()\n  }, {\n    key: \"handleData\",\n    value: function handleData(data) {\n      var result = JSON.parse(data);\n      var current_note = this.state.note;\n\n      if (this.state.current_note_id == result.id) {\n        this.setState({\n          note: result\n        });\n      }\n    }\n  }, {\n    key: \"handleOnChange\",\n    value: function handleOnChange(e) {\n      var content = e.target.value;\n      var current_note = this.state.note;\n      current_note.content = content;\n      this.setState({\n        note: current_note\n      });\n      var socket = this.refs.socket;\n      socket.state.ws.send(JSON.stringify(current_note));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var token = this.props.cookies.get('token');\n\n      if (token === null || token === \"undefined\") {\n        return window.location.replace('/auth/login');\n      } else {\n        return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Header, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 216,\n            columnNumber: 13\n          }\n        }), /*#__PURE__*/React.createElement(Container, {\n          className: \"mt--7\",\n          fluid: true,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 217,\n            columnNumber: 13\n          }\n        }, /*#__PURE__*/React.createElement(Col, {\n          xs: \"2\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 18\n          }\n        }, /*#__PURE__*/React.createElement(Button, {\n          color: \"primary\",\n          onClick: this.handleAddItem,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 25\n          }\n        }, \"Criar um novo\")), /*#__PURE__*/React.createElement(Row, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 221,\n            columnNumber: 21\n          }\n        }, /*#__PURE__*/React.createElement(Col, {\n          xs: \"4\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 222,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(ListNotes, {\n          notes: this.state.notes,\n          handleItemClick: function handleItemClick(id) {\n            return _this4.handleItemClick(id);\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 29\n          }\n        })), /*#__PURE__*/React.createElement(Col, {\n          xs: \"8\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 225,\n            columnNumber: 26\n          }\n        }, this.state.is_creating ? /*#__PURE__*/React.createElement(AddNoteForm, {\n          handleSave: this.handleSaveNote,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 33\n          }\n        }) : /*#__PURE__*/React.createElement(EditNoteForm, {\n          handleChange: this.handleOnChange,\n          note: this.state.note,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 33\n          }\n        }), /*#__PURE__*/React.createElement(Websocket, {\n          ref: \"socket\",\n          url: \"ws://localhost:8000/ws/notes\",\n          onMessage: this.handleData.bind(this),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 31\n          }\n        }))), /*#__PURE__*/React.createElement(Row, {\n          className: \"mt-5\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 235,\n            columnNumber: 15\n          }\n        }, /*#__PURE__*/React.createElement(ToastContainer, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 236,\n            columnNumber: 19\n          }\n        }))));\n      }\n    }\n  }]);\n\n  return Index;\n}(React.Component);\n\nexport default withCookies(Index);","map":{"version":3,"sources":["/home/alessandro/Desktop/backend_almir/frontend/src/views/Index.js"],"names":["React","Chart","withCookies","toast","ToastContainer","ListNotes","AddNoteForm","EditNoteForm","Websocket","Container","Row","Col","Button","chartOptions","parseOptions","Header","Index","props","sucess","success","warning","toggleNavs","e","index","preventDefault","setState","activeNav","chartExample1Data","state","url","fetchNotes","fetch","method","headers","Accept","cookies","get","then","res","json","data","fetchNote","id","addNote","note","body","JSON","stringify","console","log","notes","current_note_id","is_creating","handleItemClick","bind","handleAddItem","getData","handleSaveNote","handleOnChange","window","resp","catch","error","selected_note","prevState","result","parse","current_note","content","target","value","socket","refs","ws","send","token","location","replace","handleData","Component"],"mappings":"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","sourcesContent":["/*!\n\n=========================================================\n* Argon Dashboard React - v1.1.0\n=========================================================\n\n* Product Page: https://www.creative-tim.com/product/argon-dashboard-react\n* Copyright 2019 Creative Tim (https://www.creative-tim.com)\n* Licensed under MIT (https://github.com/creativetimofficial/argon-dashboard-react/blob/master/LICENSE.md)\n\n* Coded by Creative Tim\n\n=========================================================\n\n* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\n*/\nimport React from \"react\";\n// javascipt plugin for creating charts\nimport Chart from \"chart.js\";\nimport { withCookies } from \"react-cookie\";\nimport { toast, ToastContainer } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.min.css';\nimport ListNotes from './ListNotes';\n//import { fetchNotes, fetchNote, updateNote } from '../../src/api';\nimport AddNoteForm from \"./AddNoteForm\";\nimport EditNoteForm from \"./EditNoteForm\";\nimport Websocket from 'react-websocket';\n// reactstrap components\nimport {\n  Container,\n  Row,\n  Col,\n  Button\n} from \"reactstrap\";\n\n// core components\nimport {\n  chartOptions,\n  parseOptions,\n} from \"variables/charts.js\";\n\nimport Header from \"components/Headers/Header.js\";\n\nclass Index extends React.Component {\n   sucess = () => toast.success(\"Usuário logado com sucesso!\");\n   warning = () => toast.warning(\"Usuário não autenticado!\");\n\n  constructor(props){\n    super(props);\n\n    this.state = {\n      activeNav: 1,\n      chartExample1Data: \"data1\",\n      notes: [],\n      note: {},\n      current_note_id: 0,\n      is_creating: true\n    };\n\n    this.handleItemClick = this.handleItemClick.bind(this);\n    this.handleAddItem = this.handleAddItem.bind(this);\n    this.addNote = this.addNote.bind(this);\n    this.getData = this.getData.bind(this);\n    this.handleSaveNote = this.handleSaveNote.bind(this);\n    this.fetchNotes = this.fetchNotes.bind(this);\n    this.handleOnChange = this.handleOnChange.bind(this)\n\n    if (window.Chart) {\n      parseOptions(Chart, chartOptions());\n    }\n  }\n\n  toggleNavs = (e, index) => {\n    e.preventDefault();\n    this.setState({\n      activeNav: index,\n      chartExample1Data:\n        this.state.chartExample1Data === \"data1\" ? \"data2\" : \"data1\"\n    });\n  };\n\n   async getData(){\n     fetch(this.url, {\n        method: 'GET',\n        headers: {\n          'Authorization': `Token ${this.props.cookies.get('token')}`\n        }\n      }).then( resp => resp.json()).then( res => this.setState({notes: res}, function() {\n            console.log(this.state.notes)\n            console.log(this.props.cookies.get('token'))\n      }))\n      .catch(error => console.log(error))\n\n    }\n\n  async handleItemClick(id) {\n    let selected_note = await fetchNote(id);\n\n    this.setState((prevState) => {\n      return {\n        is_creating: false,\n        current_note_id: id,\n        note: selected_note\n      }\n    })\n  }\n\n    handleAddItem(){\n        this.setState((prevState) => {\n            return{is_creating: true}\n        })\n    }\n\n  componentDidMount(){\n       this.sucess()\n        fetch('http://127.0.0.1:8000/api/v1/notes/', {\n        method: 'GET',\n        headers: {\n          'Authorization': `Token ${this.props.cookies.get('token')}`\n        }\n      }).then( resp => resp.json()).then( res => this.setState({notes: res}, function() {\n            console.log(this.state.notes)\n            console.log(this.props.cookies.get('token'))\n      }))\n      .catch(error => console.log(error))\n    }\n\n    url = 'http://127.0.0.1:8000/api/v1/notes/';\n\n    fetchNotes = async () => {\n        fetch(this.url, {\n        method: 'POST',\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json',\n           'Authorization': `Token ${this.props.cookies.get('token')}`\n        }\n      })\n      .then(res => res.json())\n      .then(data => {\n            return(data);\n      })\n    }\n\n    fetchNote = (id) => {\n       fetch(this.url + id, {\n        method: 'GET',\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json',\n          'Authorization': `Token ${this.props.cookies.get('token')}`\n        }\n      })\n      .then(res => res.json())\n      .then(data => {\n         return(data);\n      })\n    }\n\n    addNote = (note) => {\n      fetch(this.url, {\n        method: 'POST',\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json',\n          'Authorization': `Token ${this.props.cookies.get('token')}`\n        },\n        body: JSON.stringify(note)\n      })\n      .then(res => res.json())\n      .then(data => {\n        console.log(data);\n      })\n\n      return note;\n    }\n\n    async handleSaveNote(data){\n        await this.addNote(data);\n        await this.getData();\n    }\n\n    handleData(data){\n\n        let result = JSON.parse(data);\n        let current_note = this.state.note;\n\n        if(this.state.current_note_id == result.id){\n            this.setState({note: result})\n        }\n    }\n\n handleOnChange(e) {\n    let content = e.target.value;\n    let current_note = this.state.note;\n    current_note.content = content;\n\n    this.setState({\n      note: current_note\n    });\n\n    const socket = this.refs.socket;\n    socket.state.ws.send(JSON.stringify(current_note));\n  }\n\n    render() {\n        let token = this.props.cookies.get('token')\n        if(token === null || token === \"undefined\"){\n        return (\n            window.location.replace('/auth/login')\n        )\n        }else{\n          return (\n          <>\n            <Header />\n            <Container className=\"mt--7\" fluid>\n                 <Col xs=\"2\">\n                        <Button color=\"primary\" onClick={this.handleAddItem}>Criar um novo</Button>\n                    </Col>\n                    <Row>\n                        <Col xs=\"4\">\n                            <ListNotes notes={this.state.notes} handleItemClick={(id) => this.handleItemClick(id)} />\n                        </Col>\n                         <Col xs=\"8\">\n                              {\n                                this.state.is_creating ?\n                                <AddNoteForm handleSave={this.handleSaveNote}/> :\n                                <EditNoteForm handleChange={this.handleOnChange} note={this.state.note}/>\n                              }\n                              <Websocket ref=\"socket\" url='ws://localhost:8000/ws/notes'\n                              onMessage={this.handleData.bind(this)}/>\n                         </Col>\n                    </Row>\n              <Row className=\"mt-5\">\n                  <ToastContainer />\n              </Row>\n            </Container>\n          </>\n        );\n        }\n    }\n  }\n\nexport default withCookies(Index);\n"]},"metadata":{},"sourceType":"module"}