/*!

=========================================================
* Argon Dashboard React - v1.1.0
=========================================================

* Product Page: https://www.creative-tim.com/product/argon-dashboard-react
* Copyright 2019 Creative Tim (https://www.creative-tim.com)
* Licensed under MIT (https://github.com/creativetimofficial/argon-dashboard-react/blob/master/LICENSE.md)

* Coded by Creative Tim

=========================================================

* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

*/
import React from "react";
// javascipt plugin for creating charts
//import Chart from "chart.js";
import { withCookies } from "react-cookie";
import { toast, ToastContainer } from 'react-toastify';
import 'react-toastify/dist/ReactToastify.min.css';
// reactstrap components
import { Card, CardBody, Container, Row, Col, Button } from "reactstrap";

class Pentest extends React.Component {
    constructor(props){
        super(props);
        this.state = ({
            mac: new URLSearchParams(window.location.search).get('mac'),
            ssid: new URLSearchParams(window.location.search).get('ssid')
        });

    }

    data_to_api = () => {
      let dados_rede = {"mac": this.state.mac, "ssid": this.state.ssid};
      let sucess = () => toast.success("Enviado para a API com sucesso");
      let warning = () => toast.warning("Houve um problema com a API. Tente novamente");

      fetch(`http://localhost:8000/api/dados/`, {
      method: "post",
      body: JSON.stringify(dados_rede),
      headers : {
          'Content-Type' : 'application/json',
          'Accept' : 'application/json',
          'Authorization' : `Token 90983948ea3a66581227202c25183ef2e34ac430`
        }
      })
      .then(function(response) {
          if(response){
              sucess();
          }else{
              warning();
          }
      }).then((responseBody) => {
            console.log(responseBody)
      })
    }

    render() {
          return (
          <React.Fragment>
          <>
            <div className="header bg-gradient-info pb-8 pt-5 pt-md-8">
              <Container fluid>
                <div className="header-body">
                  {/* Card stats */}
                  <div className="container">
                  <Row>
                    <Col >
                       <Card style={{'width': '500px', 'height': '230px', 'background-repeat': 'no-repeat', 'background-position': '50% 50%', 'background-size': 'cover'}} className="card-stats mb-xl-5">
                        <CardBody style={{'whiteSpace': 'pre-line'}}><img src="https://image.flaticon.com/icons/svg/2916/2916682.svg" alt="wireless" width="30px" align="left"></img>
                            <br/><br/>
                            <p>SSID: {this.state.ssid}</p>
                            <p>MAC: {this.state.mac}</p>
                            <Button variant="contained" color="primary" onClick={this.data_to_api}> Enviar </Button>
                        </CardBody>
                       </Card>
                    </Col>
                  </Row>
                  </div>
                </div>
                <ToastContainer />
              </Container>
            </div>
          </>
          </React.Fragment>
        );
       }
    }

export default withCookies(Pentest);
